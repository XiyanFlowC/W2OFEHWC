<head>
    <title>用户信息</title>
    <link rel="stylesheet" type="text/css" href="./css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="./css/site.css" />
    <script src="./js/jquery-3.5.1.min.js"></script>
</head>

<body>
    <div class='container'>
        <h1 id='name'>用户资料</h1>
        <hr />
        <table id='infoTable'>
            <tr>
                <th style="width: 5em;">项目</th>
                <th>值</th>
            </tr>
            <tr>
                <td>存储空间</td>
                <td id='storageSpace'></td>
            </tr>
            <tr>
                <td>账户名</td>
                <td id='accountName'></td>
            </tr>
            <tr>
                <td>状态</td>
                <td id='status'></td>
            </tr>
        </table>
        <div class='alert alert-danger' id='failedBar'>无法显示用户资料</div>
    </div>

    <script>
        var apirt = 'http://39.105.228.56:8080/disk'

        $(document).ready(function(){
            $('#failedBar').hide();

            $.ajax({
                url: apirt + '/user/userInfo',
                type: 'post',
                headers: {
                    Authorization: localStorage.getItem('token')
                },
                success: function(data) {
                    if(data.code == 1) {
                        // console.log(data.obj);
                        $("#storageSpace").text(data.obj.capacity + '/' + data.obj.userBean.userCapacity);
                        $("#accountName").text(data.obj.userBean.userAccount);
                        $("#status").text(data.obj.userBean.status);
                        $("#name").text(data.obj.userBean.userName + ' 的个人资料');
                    }
                    if(data.code == -1) {
                        alert(data.msg);
                        $('#infoTable').hide();
                        $('#failedBar').show();
                    }
                },
                error: function(xhr, status, error) {
                    console.log(xhr);
                    $('#infoTable').hide();
                    $('#failedBar').show();
                }
            })
        });
    </script>
</body>